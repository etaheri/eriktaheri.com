---
interface Props {
  title: string;
  description?: string;
  image?: string;
}

const { title, description = "Erik Taheri is an experienced technologist based in Buffalo, NY.", image } = Astro.props;
const ogImage = image ?? "https://eriktaheri-com.pages.dev/eriktaheri.jpg";

import "@fontsource-variable/space-grotesk";
import "@fontsource-variable/source-serif-4";
import "../styles/global.css";

import { ClientRouter } from "astro:transitions";
import { SEO } from "astro-seo";

import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import BackToTop from "@components/BackToTop.astro";
---

<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <SEO
      title={title}
      description={description}
      titleTemplate="%s | Erik Taheri"
      openGraph={{
        basic: {
          title: title,
          type: "website",
          image: ogImage,
          url: "https://eriktaheri.com",
        },
      }}
      twitter={{
        creator: "@eriktaheri",
      }}
      extend={{
        link: [
          { rel: "icon", href: "/favicon.ico" },
          {
            rel: "alternate",
            type: "application/rss+xml",
            title: "Erik Taheri",
            href: "/rss.xml",
          },
        ],
      }}
    />
    <ClientRouter />
    <meta name="theme-color" content="#ffffff" />
    <script is:inline>
      (function () {
        const theme = localStorage.getItem("theme") || "system";
        const isDark =
          theme === "dark" ||
          (theme === "system" &&
            window.matchMedia("(prefers-color-scheme: dark)").matches);
        if (isDark) document.documentElement.classList.add("dark");
        document.querySelector('meta[name="theme-color"]').setAttribute("content", isDark ? "#0a0a0a" : "#ffffff");
      })();
    </script>
  </head>
  <body
    class="flex min-h-full flex-col bg-[var(--color-bg)] text-[var(--color-text)] antialiased transition-colors duration-300"
  >
    <Header />
    <slot />
    <Footer />
    <BackToTop />

    <script>
      function initAnimations() {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("show");
              }
            });
          },
          { threshold: 0.1 }
        );

        document.querySelectorAll(".animate").forEach((el) => {
          observer.observe(el);
        });
      }

      initAnimations();
      document.addEventListener("astro:after-swap", initAnimations);
    </script>
  </body>
</html>
